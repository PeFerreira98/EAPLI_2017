package eapli.ecafeteria.domain.users;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;

import eapli.framework.domain.AggregateRoot;
<<<<<<< HEAD
import eapli.framework.domain.Authorisable;

public class User implements AggregateRoot<Username>, Authorisable<ActionRight> {
=======
import eapli.framework.dto.DTOable;
import eapli.framework.dto.GenericDTO;
import eapli.util.DateTime;

public class User implements AggregateRoot<Username>, DTOable<User> {
>>>>>>> eb9cd70b06081ee6a54d6df63eb80b4d9f801f95

	private final Username	   username;
	private final Password	   password;
	private final Name		   name;
	private final EmailAddress email;
	private final List<Role>   roles;
	private final Calendar	   createdOn;

	public User(String username, String password, String firstName, String lastName, String email,
	        List<RoleType> roles) {
		createdOn = DateTime.now();
		this.username = new Username(username);
		this.password = new Password(password);
		name = new Name(firstName, lastName);
		this.email = new EmailAddress(email);
		this.roles = new ArrayList<Role>();
		for (final RoleType rt : roles) {
			this.roles.add(new Role(rt, createdOn));
		}
	}


	public User(Username username, Password password) {
		this.username = username;
		this.password = password;
	}

	@Override
	public Username id() {
		return username;
	}

<<<<<<< HEAD
	/**
	 * Add role to user
	 * @param role
     */
	public void addRole(Role role) {
		roles.add(role);
	}

	/**
	 * Add role to user
	 * @param role
	 */
	public void removeRole(Role role) {
		roles.remove(role);
	}

	@Override
	public boolean isAuthorizedTo(ActionRight action) {

			throw new UnsupportedOperationException("Not supported yet.");
	}

	public void passwordMatches(Password password) throws InvalidPasswordException {
		if (!this.password.equals(password))
		{
			throw new InvalidPasswordException("Password does note match", this);
		}

=======
	@Override
	public GenericDTO toDTO() {
		final GenericDTO ret = new GenericDTO("user");
		ret.put("username", username.toString());
		ret.put("password", password.toString());
		ret.put("name", name.toString());
		ret.put("email", email.toString());

		return ret;
>>>>>>> eb9cd70b06081ee6a54d6df63eb80b4d9f801f95
	}
}
